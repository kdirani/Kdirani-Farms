# ุชูููุฐ ุงูุชูุฑูุฑ ุงููููู ุงููุชูุงูู ูุน ุงูููุงุชูุฑ

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุธุงู ูุชูุงูู ูุฅูุดุงุก ุงูุชูุฑูุฑ ุงููููู ูุชุถูู ุฅูุดุงุก ุงูููุงุชูุฑ ุงูุชุงููุฉ ุชููุงุฆูุงู:
1. **ูุงุชูุฑุฉ ูุจูุน ุงูุจูุถ** - ุชููุต ูู ุงููุฎุฒูู ุนุจุฑ ุญูู `sales`
2. **ูุงุชูุฑุฉ ูุจูุน ุงูุณูุงุฏ** - ุชููุต ูู ุงููุฎุฒูู ุนุจุฑ ุญูู `sales`
3. **ูุงุชูุฑุฉ ุงุณุชููุงู ุงูุฃุฏููุฉ** - ุชููุต ูู ุงููุฎุฒูู ุนุจุฑ ุญูู `consumption`

---

## ๐๏ธ ุงููููุงุช ุงูุฌุฏูุฏุฉ

### 1. `actions/integrated-daily-report.actions.ts`
**ุงููุธููุฉ:** ููู ุงูุฃูุดู ุงูุฑุฆูุณู ุงูุฐู ูุชุนุงูู ูุน ุฅูุดุงุก ุงูุชูุฑูุฑ ุงููููู ูุงูููุงุชูุฑ ุงููุฑุชุจุทุฉ.

**ุงูุฏูุงู ุงูุฑุฆูุณูุฉ:**
- `createIntegratedDailyReport()` - ุฅูุดุงุก ุงูุชูุฑูุฑ ุงููููู ูุน ุฌููุน ุงูููุงุชูุฑ
- `getWarehouseMedicines()` - ุฌูุจ ุงูุฃุฏููุฉ ุงููุชุงุญุฉ ูู ุงููุณุชูุฏุน
- `getAvailableMedicineQuantity()` - ุฌูุจ ุงููููุฉ ุงููุชุงุญุฉ ูุฏูุงุก ูุนูู
- `getOrCreateMaterial()` - ุฅูุดุงุก ุฃู ุฌูุจ ูุงุฏุฉ (ุจูุถุ ุณูุงุฏ)
- `updateMaterialInventory()` - ุชุญุฏูุซ ุงููุฎุฒูู
- `isFirstReport()` - ุงูุชุญูู ูู ุฃูู ุงูุชูุฑูุฑ ุงูุฃูู
- `getChicksFromPoultryStatus()` - ุฌูุจ ุนุฏุฏ ุงูุฏุฌุงุฌ ูู ุงููุทูุน

**ุขููุฉ ุงูุนูู:**
1. ุงูุชุญูู ูู ุฃูู ุงูุชูุฑูุฑ ุงูุฃูู โ ุฌูุจ ุนุฏุฏ ุงูุฏุฌุงุฌ ูู `poultry_status`
2. ุฅูุดุงุก ุฃู ุฌูุจ ูุงุฏุฉ "ุจูุถ" ูู ุงููุณุชูุฏุน
3. ุชุญุฏูุซ ุงููุฎุฒูู:
   - **ุงูุจูุถ ุงูุณููู** โ ููุถุงู ูู `purchases`
   - **ุงูุจูุถ ุงููุฏุงูุง** โ ููููุต ูู `consumption`
4. ุฅูุดุงุก ุงูุชูุฑูุฑ ุงููููู ูุน ุงูุญุณุงุจุงุช ุงูุชููุงุฆูุฉ
5. ุฅูุดุงุก ููุงุชูุฑ ุงูุจูุน ูุงูุงุณุชููุงู

**ุชูููุฏ ุฑูู ุงููุงุชูุฑุฉ:**
```typescript
function generateInvoiceNumber(prefix: string): string {
  return `${prefix}-${Date.now()}`;
}
```
- ูุงุชูุฑุฉ ุจูุน ุงูุจูุถ: `EGG-SALE-{timestamp}`
- ูุงุชูุฑุฉ ุจูุน ุงูุณูุงุฏ: `DROP-SALE-{timestamp}`
- ูุงุชูุฑุฉ ุงุณุชููุงู ุงูุฃุฏููุฉ: `MED-CONS-{timestamp}`

---

### 2. `components/farmer/integrated-daily-report-form.tsx`
**ุงููุธููุฉ:** ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงููุชูุงููุฉ ูุฅูุดุงุก ุงูุชูุฑูุฑ ุงููููู ูุน ุงูููุงุชูุฑ.

**ุงูุฃูุณุงู ุงูุฑุฆูุณูุฉ:**

#### ๐ ูุนูููุงุช ุงูุชูุฑูุฑ ุงูุฃุณุงุณูุฉ
- ุงูุชุงุฑูุฎ ูุงูููุช

#### ๐ฅ ุฅูุชุงุฌ ุงูุจูุถ
- ุจูุถ ุตุญู (ูุฏุฎู ุงููุฎุฒูู)
- ุจูุถ ูุดูู (ูุง ูุฏุฎู ุงููุฎุฒูู)
- ุฅุฌูุงูู ุงูุฅูุชุงุฌ (ูุญุณูุจ ุชููุงุฆูุงู)
- ุงูุฑุตูุฏ ุงูุณุงุจู
- ุงูุจูุถ ุงููุจุงุน
- ุจูุถ ุงููุฏุงูุง
- ุงูุฑุตูุฏ ุงูุญุงูู (ูุญุณูุจ ุชููุงุฆูุงู)
- ุงุณุชููุงู ุงููุฑุงุชูู

#### ๐ ุญุงูุฉ ุงููุทูุน
- ุงูุนุฏุฏ ูุจู (ููุฌูุจ ุชููุงุฆูุงู ููุชูุฑูุฑ ุงูุฃูู)
- ุงููุงูู
- ุงูุนุฏุฏ ุจุนุฏ (ูุญุณูุจ ุชููุงุฆูุงู)
- ูุณุจุฉ ุงูุฅูุชุงุฌ (ูุญุณูุจุฉ ุชููุงุฆูุงู)

#### ๐พ ุงูุนูู ูุงูุณูุงุฏ
- ุงูุนูู ุงููููู
- ุงูุนูู ุงูุดูุฑู
- ูุนุฏู ุงูุชุญููู
- ุฅูุชุงุฌ ุงูุณูุงุฏ

#### ๐ฆ ูุงุชูุฑุฉ ูุจูุน ุงูุจูุถ (ุงุฎุชูุงุฑู)
**ุงูุญููู:**
- ุงูุฒุจูู (ูุงุฆูุฉ ุจุงูุฒุจุงุฆู)
- ูุฒู ุงูุจูุถ (ูุงุฆูุฉ ุจุงูุฃูุฒุงู)
- ุงููุญุฏุฉ (ูุงุฆูุฉ ุจุงููุญุฏุงุช)
- ุงููููุฉ
- ุงูุณุนุฑ
- ุงููุจูุบ (ูุญุณูุจ ุชููุงุฆูุงู = ุงููููุฉ ร ุงูุณุนุฑ)

**ุงูููุฒุงุช:**
- ุฅููุงููุฉ ุฅุถุงูุฉ ุนุฏุฉ ุจููุฏ (ุฃูุฒุงู ูุฎุชููุฉ)
- ุนุฑุถ ุงูุจููุฏ ุงููุถุงูุฉ ูุน ุฅููุงููุฉ ุงูุญุฐู
- ุญุณุงุจ ุงููุจูุบ ุงูุฅุฌูุงูู ุชููุงุฆูุงู

#### ๐ฉ ูุงุชูุฑุฉ ูุจูุน ุงูุณูุงุฏ (ุงุฎุชูุงุฑู)
**ุงูุญููู:**
- ุงูุฒุจูู (ูุงุฆูุฉ ุจุงูุฒุจุงุฆู)
- ุงููุญุฏุฉ (ูุงุฆูุฉ ุจุงููุญุฏุงุช)
- ุงููููุฉ
- ุงูุณุนุฑ
- ุงููุจูุบ (ูุญุณูุจ ุชููุงุฆูุงู)

#### ๐ ูุงุชูุฑุฉ ุงุณุชููุงู ุงูุฃุฏููุฉ (ุงุฎุชูุงุฑู)
**ุงูุญููู:**
- ุงููุทูุน (ูุงุฆูุฉ ุจุงููุทุนุงู)
- ุงูุฏูุงุก (ูุงุฆูุฉ ุจุงูุฃุฏููุฉ ุงููุชุงุญุฉ ูู ุงููุฎุฒู ููุท)
- ุงููุญุฏุฉ
- ุงููููุฉ
- ุงูุณุนุฑ
- ุงููุจูุบ (ูุญุณูุจ ุชููุงุฆูุงู)

**ุงูููุฒุงุช ุงูุฎุงุตุฉ:**
- โ **ุนุฑุถ ุงููููุฉ ุงููุชุงุญุฉ** ููู ุฏูุงุก ุจุฌุงูุจ ุงุณูู
- โ **ุญุณุงุจ ุงููููุฉ ุงููุชุงุญุฉ ุฏููุงููููุงู** ูุน ุงูุฃุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ:
  - ุงููููุฉ ุงูุญุงููุฉ ูู ุงููุฎุฒูู
  - ุงูุจููุฏ ุงููุถุงูุฉ ูู ุงูููุฑู (ูู ุชูุญูุธ ุจุนุฏ)
  - ุงูุจูุถ ุงูุณููู ุงูููุถุงู ูู ููุณ ุงูุชูุฑูุฑ
- โ **ููุน ุฅุถุงูุฉ ูููุฉ ุฃูุจุฑ ูู ุงููุชุงุญ**
- ุฅููุงููุฉ ุฅุถุงูุฉ ุนุฏุฉ ุฃุฏููุฉ ูู ููุณ ุงููุงุชูุฑุฉ

#### ๐ ุงููุฑููุงุช
- ุฅููุงููุฉ ุฑูุน ุญุชู 5 ูููุงุช (ุตูุฑุ PDFุ ูุณุชูุฏุงุช)

---

## ๐ ุขููุฉ ุชุญุฏูุซ ุงููุฎุฒูู

### 1. ุงูุจูุถ ุงูุณููู
```typescript
// ููุถุงู ุฅูู ุงููุฎุฒูู ูู purchases
await updateMaterialInventory(
  supabase,
  warehouse_id,
  eggMaterialId,
  'purchases',
  production_eggs_healthy
);
```

### 2. ุงูุจูุถ ุงููุฏุงูุง
```typescript
// ููููุต ูู ุงููุฎุฒูู ูู consumption
await updateMaterialInventory(
  supabase,
  warehouse_id,
  eggMaterialId,
  'consumption',
  eggs_gift
);
```

### 3. ูุงุชูุฑุฉ ูุจูุน ุงูุจูุถ
```typescript
// ููููุต ูู ุงููุฎุฒูู ูู sales
await updateMaterialInventory(
  supabase,
  warehouse_id,
  eggMaterialId,
  'sales',
  item.quantity
);
```

### 4. ูุงุชูุฑุฉ ูุจูุน ุงูุณูุงุฏ
```typescript
// ููููุต ูู ุงููุฎุฒูู ูู sales
await updateMaterialInventory(
  supabase,
  warehouse_id,
  droppingsMaterialId,
  'sales',
  quantity
);
```

### 5. ูุงุชูุฑุฉ ุงุณุชููุงู ุงูุฃุฏููุฉ
```typescript
// ููููุต ูู ุงููุฎุฒูู ูู consumption
const newConsumption = material.consumption + item.quantity;
const newBalance = Math.max(0, material.current_balance - item.quantity);
```

---

## ๐ ุงูุญุณุงุจุงุช ุงูุชููุงุฆูุฉ

### ูู ุงูุชูุฑูุฑ ุงููููู:
```typescript
// ุฅุฌูุงูู ุงูุฅูุชุงุฌ
production_eggs = production_eggs_healthy + production_eggs_deformed

// ูุณุจุฉ ุงูุฅูุชุงุฌ
production_egg_rate = (production_eggs / chicks_before) * 100

// ุงูุฑุตูุฏ ุงูุญุงูู
current_eggs_balance = previous_eggs_balance + production_eggs_healthy - eggs_sold - eggs_gift

// ุงูุนุฏุฏ ุจุนุฏ
chicks_after = chicks_before - chicks_dead
```

### ูู ุงูููุงุชูุฑ:
```typescript
// ูููุฉ ุงูุจูุฏ
value = quantity * price

// ุฅุฌูุงูู ุงููุงุชูุฑุฉ
total_value = sum(items.map(item => item.value))
```

---

## ๐ฏ ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1. โ ุฅูุดุงุก ุงูููุงุฏ ุชููุงุฆูุงู
- ุนูุฏ ุฅูุดุงุก ุฃูู ุชูุฑูุฑุ ูุชู ุฅูุดุงุก ูุงุฏุฉ "ุจูุถ" ุชููุงุฆูุงู
- ุนูุฏ ุจูุน ุงูุณูุงุฏุ ูุชู ุฅูุดุงุก ูุงุฏุฉ "ุณูุงุฏ" ุชููุงุฆูุงู

### 2. โ ุฌูุจ ุนุฏุฏ ุงูุฏุฌุงุฌ ููุชูุฑูุฑ ุงูุฃูู
- ูุชู ุฌูุจ ุนุฏุฏ ุงูุฏุฌุงุฌ ูู `poultry_status` ุชููุงุฆูุงู ููุชูุฑูุฑ ุงูุฃูู
- ููุชูุงุฑูุฑ ุงููุงุญูุฉุ ููุฏุฎู ุงููุณุชุฎุฏู ุงูุนุฏุฏ ูุฏููุงู

### 3. โ ุนุฑุถ ุงููููุฉ ุงููุชุงุญุฉ ููุฃุฏููุฉ
- ูุชู ุนุฑุถ ุงููููุฉ ุงููุชุงุญุฉ ุจุฌุงูุจ ุงุณู ูู ุฏูุงุก
- ูุชู ุญุณุงุจ ุงููููุฉ ูุน ุงูุฃุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ ุงูุจูุงูุงุช ุบูุฑ ุงููุญููุธุฉ

### 4. โ ููุน ุงูุฃุฎุทุงุก
- ููุน ุฅุถุงูุฉ ูููุฉ ุฏูุงุก ุฃูุจุฑ ูู ุงููุชุงุญ
- ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช ูุจู ุงูุญูุธ
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ

### 5. โ ุชูุงูู ูุงูู
- ุญูุธ ุงูุชูุฑูุฑ ูุงูููุงุชูุฑ ูู ุนูููุฉ ูุงุญุฏุฉ
- ุชุญุฏูุซ ุงููุฎุฒูู ุชููุงุฆูุงู
- revalidate ุฌููุน ุงูุตูุญุงุช ุงููุชุฃุซุฑุฉ

---

## ๐ง ููููุฉ ุงูุงุณุชุฎุฏุงู

### ูููุทูุฑ:
1. ุงุณุชุจุฏุงู ุงุณุชูุฑุงุฏ ุงููููุจูููุช ุงููุฏูู ุจุงูุฌุฏูุฏ:
```typescript
// ูุฏูู
import DailyReportForm from '@/components/farmer/daily-report-form';

// ุฌุฏูุฏ
import IntegratedDailyReportForm from '@/components/farmer/integrated-daily-report-form';
```

2. ุงุณุชุฎุฏุงู ุงููููุจูููุช ุงูุฌุฏูุฏ:
```tsx
<IntegratedDailyReportForm
  warehouseId={warehouseId}
  warehouseName={warehouseName}
  farmId={farmId}
  eggWeights={eggWeights}
  materialsNames={materialsNames}
  units={units}
  expenseTypes={expenseTypes}
  clients={clients}
  medicines={medicines}
  poultryStatus={poultryStatus}
/>
```

### ูููุณุชุฎุฏู (ุงููุฒุงุฑุน):
1. ูุชุญ ุตูุญุฉ ุฅุถุงูุฉ ุชูุฑูุฑ ูููู: `/farmer/daily-report`
2. ููุก ูุนูููุงุช ุงูุชูุฑูุฑ ุงูุฃุณุงุณูุฉ
3. (ุงุฎุชูุงุฑู) ุฅุถุงูุฉ ููุงุชูุฑ ูุจูุน ุงูุจูุถ
4. (ุงุฎุชูุงุฑู) ุฅุถุงูุฉ ูุงุชูุฑุฉ ูุจูุน ุงูุณูุงุฏ
5. (ุงุฎุชูุงุฑู) ุฅุถุงูุฉ ููุงุชูุฑ ุงุณุชููุงู ุงูุฃุฏููุฉ
6. (ุงุฎุชูุงุฑู) ุฅุฑูุงู ูููุงุช
7. ุงูุถุบุท ุนูู "ุญูุธ ุงูุชูุฑูุฑ ูุงูููุงุชูุฑ"

---

## ๐ ููุงุญุธุงุช ูููุฉ

### 1. ุงูุจูุถ ุงููุดูู
- **ูุง ูุฏุฎู ุงููุฎุฒูู ุฃุจุฏุงู** (ููุง ูู ูุทููุจ)
- ููุณุชุฎุฏู ููุท ูู ุญุณุงุจ ุฅุฌูุงูู ุงูุฅูุชุงุฌ ููุณุจุฉ ุงูุฅูุชุงุฌ

### 2. ุงููุญุฏุงุช ุงูุงูุชุฑุงุถูุฉ
- ุงูุจูุถ: "ูุฑุชููุฉ"
- ุงูุณูุงุฏ: "ูููู ุฌุฑุงู"
- ูุฌุจ ุงูุชุฃูุฏ ูู ูุฌูุฏ ูุฐู ุงููุญุฏุงุช ูู ุฌุฏูู `measurement_units`

### 3. ุงูุฃุฏููุฉ
- ูุชู ุนุฑุถ ุงูุฃุฏููุฉ ุงููุชุงุญุฉ ูู ุงููุฎุฒูู ููุท (current_balance > 0)
- ุงูุฃุฏููุฉ ูุฎุฒูุฉ ูู ุฌุฏูู `materials` ูุน `medicine_id`

### 4. ุงูููุงุชูุฑ ุงุฎุชูุงุฑูุฉ
- ุฌููุน ุงูููุงุชูุฑ ุงุฎุชูุงุฑูุฉ
- ูููู ุฅูุดุงุก ุชูุฑูุฑ ูููู ุจุฏูู ุฃู ูุงุชูุฑุฉ
- ูููู ุฅุถุงูุฉ ูุงุชูุฑุฉ ูุงุญุฏุฉ ุฃู ุฃูุซุฑ ุญุณุจ ุงูุญุงุฌุฉ

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ ุงููุทููุจุฉ:

1. โ **ุฅูุดุงุก ุชูุฑูุฑ ุฃูู**
   - ุงูุชุญูู ูู ุฌูุจ ุนุฏุฏ ุงูุฏุฌุงุฌ ุชููุงุฆูุงู
   - ุงูุชุญูู ูู ุฅูุดุงุก ูุงุฏุฉ "ุจูุถ" ุชููุงุฆูุงู

2. โ **ุฅูุดุงุก ุชูุฑูุฑ ูุน ูุงุชูุฑุฉ ุจูุน ุจูุถ**
   - ุงูุชุญูู ูู ุชุญุฏูุซ ุงููุฎุฒูู (sales)
   - ุงูุชุญูู ูู ุฅูุดุงุก ุงููุงุชูุฑุฉ ุจูุฌุงุญ

3. โ **ุฅูุดุงุก ุชูุฑูุฑ ูุน ูุงุชูุฑุฉ ุจูุน ุณูุงุฏ**
   - ุงูุชุญูู ูู ุฅูุดุงุก ูุงุฏุฉ "ุณูุงุฏ" ุชููุงุฆูุงู
   - ุงูุชุญูู ูู ุชุญุฏูุซ ุงููุฎุฒูู

4. โ **ุฅูุดุงุก ุชูุฑูุฑ ูุน ูุงุชูุฑุฉ ุงุณุชููุงู ุฃุฏููุฉ**
   - ุงูุชุญูู ูู ุนุฑุถ ุงููููุฉ ุงููุชุงุญุฉ
   - ุงูุชุญูู ูู ููุน ุฅุถุงูุฉ ูููุฉ ุฃูุจุฑ ูู ุงููุชุงุญ
   - ุงูุชุญูู ูู ุชุญุฏูุซ ุงููุฎุฒูู (consumption)

5. โ **ุฅูุดุงุก ุชูุฑูุฑ ูุน ุฌููุน ุงูููุงุชูุฑ**
   - ุงูุชุญูู ูู ุฅูุดุงุก ุฌููุน ุงูููุงุชูุฑ ุจูุฌุงุญ
   - ุงูุชุญูู ูู ุชุญุฏูุซ ุงููุฎุฒูู ุจุดูู ุตุญูุญ

6. โ **ุงูุญุณุงุจุงุช ุงูุชููุงุฆูุฉ**
   - ุงูุชุญูู ูู ุญุณุงุจ ุฅุฌูุงูู ุงูุฅูุชุงุฌ
   - ุงูุชุญูู ูู ุญุณุงุจ ูุณุจุฉ ุงูุฅูุชุงุฌ
   - ุงูุชุญูู ูู ุญุณุงุจ ุงูุฑุตูุฏ ุงูุญุงูู
   - ุงูุชุญูู ูู ุญุณุงุจ ุงูุนุฏุฏ ุจุนุฏ

---

## ๐ฎ ุงูุชุญุณููุงุช ุงููุณุชูุจููุฉ ุงูููุชุฑุญุฉ

1. **ุฅุถุงูุฉ ุชูุงุฑูุฑ ุชูุตูููุฉ**
   - ุชูุฑูุฑ ุจุฌููุน ุงูููุงุชูุฑ ุงููุฑุชุจุทุฉ ุจุชูุฑูุฑ ูููู ูุนูู

2. **ุฅุถุงูุฉ ุฅุดุนุงุฑุงุช**
   - ุฅุดุนุงุฑ ุนูุฏ ููุงุฏ ุฏูุงุก ูุนูู
   - ุฅุดุนุงุฑ ุนูุฏ ุงูุฎูุงุถ ูุฎุฒูู ุงูุจูุถ

3. **ุฅุถุงูุฉ ุชุญูููุงุช**
   - ุฑุณูู ุจูุงููุฉ ูุฅูุชุงุฌ ุงูุจูุถ
   - ููุงุฑูุฉ ุจูู ุงูุชูุงุฑูุฑ ุงูููููุฉ

4. **ุชุญุณูู ุงูุฃุฏุงุก**
   - ุงุณุชุฎุฏุงู transactions ูุถูุงู ุชูุงูู ุงูุจูุงูุงุช
   - ุฅุถุงูุฉ caching ููุจูุงูุงุช ุงููุชูุฑุฑุฉ

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** 2025-10-05  
**ุงูุฅุตุฏุงุฑ:** 1.0  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุงุฎุชุจุงุฑ
